<!-- Include Font Awesome. -->
<link href="/js/froala_editor_1.2.4/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<!-- Include Editor style. -->
<link href="/js/froala_editor_1.2.4/css/froala_editor.min.css" rel="stylesheet" type="text/css" />
<link href="/js/froala_editor_1.2.4/css/froala_style.min.css" rel="stylesheet" type="text/css" />

<!-- Include jQuery. -->
<script src="http://code.jquery.com/jquery-1.11.0.js"></script>

<script src="/js/froala_editor_1.2.4/js/froala_editor.min.js" type="text/javascript"></script>
<script src="/js/froala_editor_1.2.4/js/plugins/colors.min.js"></script>
<script src="/js/froala_editor_1.2.4/js/plugins/media_manager.min.js"></script>
<script src="/js/froala_editor_1.2.4/js/plugins/block_styles.min.js"></script>
<script src="/js/froala_editor_1.2.4/js/plugins/lists.min.js"></script>
<script src="/js/froala_editor_1.2.4/js/plugins/video.min.js"></script>

<form>
	<div class="fbeditor">
		<input id="title" name="title" value="" placeholder="Title">
		<span id="status"></span>
	</div>
	<textarea id="edit" name="content"></textarea>
</form>

<!-- Include IE8 JS. -->
<!--[if lt IE 9]>
<script src="/js/froala_editor_1.2.4/js/froala_editor_ie8.min.js"></script>
<![endif]-->

<!-- Initialize the editor. -->
<script>
	$(function() {
		$('#edit').editable({
			inlineMode: false,
			imagesLoadURL: "/api/images.json",
			imageUploadURL: "/api/images.json",
			imageDeleteURL: "/api/delete_image.json",
			pastedImagesUploadURL: "/api/pasted_image.json",
			saveURL: "/api/save",
			autosave: true,
			autosaveInterval: 3000,
			saveParams: {id: 0, title: ""}
		}).on('editable.afterSave', function (e, editor, data) {
	  		if (data.id > 0 ) {
	  			var saveParams = $("#edit").editable("option", "saveParams");
	  			saveParams.id = data.id;
	  			saveParams.title = data.title;
	  			$("#edit").editable("option", "saveParams", saveParams);
	  			$("#title").val(data.title);
	  			$("#status").text("All changes have been saved.");
	  		}else{
	  			$("#status").text("Error")
	  		}
		}).on('editable.beforeSave', function (e, editor) {
			var saveParams = $("#edit").editable("option", "saveParams");
			saveParams.title = $("#title").val();
  			$("#edit").editable("option", "saveParams", saveParams);
  			$("#status").text("Saving...");
		}).on('editable.contentChanged', function (e, editor) {
  			$("#status").text("Unsaved changes.");
		})
	});
	$('#title').change(function() {
		$("#status").text("Unsaved changes.");
		$("#edit").editable("setDirty", true);
	});
</script>